---
- name: System Users | Create necessary users and groups
  ansible.builtin.include_tasks: groups.yaml
  when: kafka_system_users.enabled
  tags:
    - groups
    - installation

- name: SE Linux | Install Python SE Linux lib
  ansible.builtin.import_tasks: python-selinux.yaml
  tags:
    - installation

- name: Installation | Download Confluent package if needed
  ansible.builtin.import_tasks: download.yaml
  tags:
    - download
    - installation

- name: Installation | Create necessary directories
  ansible.builtin.import_tasks: directories.yaml
  tags:
    - installation

- name: Zookeeper | Include tasks
  ansible.builtin.include_tasks: zookeeper.yaml
  when: inventory_hostname in zookeeper_group
  tags:
    - service
    - installation
    - configuration

- name: Logs | Import tasks
  ansible.builtin.import_tasks: "logs.yaml"
  tags:
    - service
    - logs
    - configuration

- name: Kafka | Including tasks
  ansible.builtin.include_tasks: "kafka.yaml"
  when: inventory_hostname in kafka_group
  tags:
    - service
    - installation
    - configuration

# TO-DO: Make TLS useful again
# - name: Configure security layer for Kafka
#   ansible.builtin.import_tasks: "security.yaml"
#   vars:
#     jkstores:
#       - "{{ kafka_security.server.keystore }}"
#       - "{{ kafka_security.server.truststore }}"
#     keypass: "{{ keypass }}"
#     templates:
#       - kafka.properties
#     service: kafka
#   tags:
#     - ssl

- name: Kafka | Configure and create default topics
  ansible.builtin.include_tasks: "configure-topics.yaml"
  when: default_kafka_topics is defined
  tags:
    - kafka-topics
